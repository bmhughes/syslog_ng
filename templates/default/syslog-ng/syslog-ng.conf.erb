@version:<%= @version %>
<% unless nil_or_empty?(@preinclude) -%>
<% @preinclude.each do |file| -%>
@include "<%= file %>"
<% end -%>
<% end -%>

#
# Generated by Chef for <%= node['fqdn'] %>
# Do NOT modify this file by hand, any changes will be overwritten.
#

# syslog_ng configuration file.
#
# This should behave pretty much like the original syslog on RedHat. But
# it could be configured a lot smarter.
#
# See syslog_ng(8) and syslog_ng.conf(5) for more information.
#
# Note: it also sources additional configuration files (*.conf)
#       located in /etc/syslog_ng/conf.d/
<% unless nil_or_empty?(@options) -%>

# Options
options {
  <% @options.each do |key, value| -%>
  <%= key %>(<%= format_parameter_value(value) %>);
  <% end -%>
};
<% end -%>
<% unless nil_or_empty?(@blocks) -%>

# Blocks
<% @blocks.each do |block, config| -%>
<%= block -%>(<%= build_parameter_string(:block, config) -%>)
<% end -%>
<% end -%>
<% unless nil_or_empty?(@source) -%>

# Sources
<% @source.each do |name, config| -%>
source <%= name -%> {
  <% config.each do |driver, parameters| -%>
  <%= source_builder(driver: driver, parameters: parameters) %>
  <% end -%>
};
<% end -%>
<% end -%>
<% unless nil_or_empty?(@destination) -%>

# Destinations
<% @destination.each do |name, config| -%>
destination <%= name -%> {
  <% config.each do |driver, parameters| -%>
  <%= destination_builder(driver: driver, parameters: parameters) %>
  <% end -%>
};
<% end -%>
<% end -%>
<% unless nil_or_empty?(@filter) -%>

# Filters
<% @filter.each do |name, config| -%>
filter <%= name %> {
  <%= filter_builder(config) %>;
};
<% end -%>
<% end -%>
<% unless nil_or_empty?(@log) -%>

# Logs
<% @log.each do |name, config| -%>
log {
  <% config.each do |element, values| -%>
  <% values.each do |value| -%>
  <%= element %>(<%= value %>);
  <% end -%>
  <% end -%>
};
<% end -%>
<% end -%>
<% unless nil_or_empty?(@config_dirs) -%>

# Include configuration directories
<% @config_dirs.each do |dir| -%>
@include "<%= dir %>/*.conf"
<% end -%>
<% end -%>
<% unless nil_or_empty?(@include) -%>

# Source additional configuration files (.conf extension only)
<% @include.each do |file| -%>
@include "<%= file %>"
<% end -%>
<% end -%>

# vim:ft=syslog_ng:ai:si:ts=4:sw=4:et:
